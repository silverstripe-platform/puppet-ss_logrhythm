[sources.syslog]
type = "syslog"
address = "<%= @listen_ip %>:<%= @listen_port %>"
mode = "<%= @listen_mode %>"

[transforms.modify_syslog]
type = "remap"
inputs = ["syslog"]
source = '''
  .host = "${HOSTNAME}"
  .hostname = "${HOSTNAME}"
  .message = encode_json(.) + "\n"
'''

[sinks.kinesis]
type = "aws_kinesis_streams"
inputs = [ "modify_syslog" ]
compression = "none"
region = "${REGION}"
stream_name = "${STREAM_NAME}"
auth.assume_role = "${ROLE_ARN}"
encoding.codec = "text"